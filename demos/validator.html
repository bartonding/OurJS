<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Validator</title>
<link rel="stylesheet" href="../stylesheets/framework.css">
<script src="../dev.js"></script>
<script src="../src/components/validator.js"></script>
<style>
table { table-layout: fixed; width: 600px; }
col.key { width: 100px; }
col.value { width: 220px; }
th { text-align: right; }
th.submit { text-align: center; }
textarea { resize: none; }

span.success { border: 1px solid #D6E9C6; background: #DFF0D8; color: #468847; }
span.failure { border: 1px solid #EED3D7; background: #F2DEDE; color: #B94A48; }
</style>
</head>
<body>
<div id="content">
  <h1>Validator</h1>
  <fieldset>
    <legend>表单验证</legend>
    <form id="form" method="get" action="http://www.lianzhong.com/">
      <table>
        <colgroup>
          <col class="key">
          <col class="value">
          <col class="message">
        </colgroup>
        <tbody>
          <tr>
            <th>姓名：</th>
            <td><input name="name" type="text" value=""></td>
            <td><span id="msg_name"></span></td>
          </tr>
          <tr>
            <th>信箱：</th>
            <td><input name="email" type="text"></td>
            <td><span id="msg_email"></span></td>
          </tr>
          <tr>
            <th>年龄：</th>
            <td><input name="age" type="text" value="28"></td>
            <td><span id="msg_age"></span></td>
          </tr>
          <tr>
            <th>密码：</th>
            <td><input name="password" type="password"></td>
            <td><span id="msg_password"></span></td>
          </tr>
          <tr>
            <th>重复密码：</th>
            <td><input name="password_confirm" type="password"></td>
            <td><span id="msg_password_confirm"></span></td>
          </tr>
          <tr>
            <th>操作系统：</th>
            <td>
              <select name="os">
                <option value="Win98">Win98</option>
                <option value="WinXP">WinXP</option>
                <option value="Win7" selected>Win7</option>
                <option value="MacOS">MacOS</option>
              </select>
            </td>
            <td><span id="msg_os"></span></td>
          </tr>
          <tr>
            <th>玩过的游戏：</th>
            <td>
              <select name="games" size="5" multiple>
                <option value="pal">仙剑奇侠传</option>
                <option value="sc">星际争霸</option>
                <option value="wow">魔兽世界</option>
                <option value="doom">毁灭战士</option>
                <option value="quake">雷神之锤</option>
              </select>
            </td>
            <td><span id="msg_games"></span></td>
          </tr>
          <tr>
            <th>语言能力：</th>
            <td>
              <input name="language" value="汉语" type="checkbox">汉语
              <input name="language" value="英语" type="checkbox">英语
              <input name="language" value="法语" type="checkbox">法语
              <input name="language" value="日语" type="checkbox">日语
            </td>
            <td><span id="msg_language"></span></td>
          </tr>
          <tr>
            <th>所在省份：</th>
            <td>
              <input name="from" value="广东" type="radio">广东
              <input name="from" value="湖南" type="radio">湖南
              <input name="from" value="浙江" type="radio">浙江
              <input name="from" value="江苏" type="radio">江苏<br>
              <input name="from" value="黑龙江" type="checkbox">黑龙江
              <input name="from" value="吉林" type="checkbox">吉林
              <input name="from" value="辽宁" type="checkbox">辽宁<br>
              <input name="from" type="text">
            </td>
            <td><span id="msg_from"></span></td>
          </tr>
          <tr>
            <th>自我介绍：</th>
            <td><textarea name="description" rows="5" cols="25"></textarea></td>
            <td><span id="msg_description"></span></td>
          </tr>
          <tr>
            <th colspan="3" class="submit">
              <button type="submit">确定提交</button>
            </th>
          </tr>
        </tbody>
      </table>
    </form>
  </fieldset>
  <script>
  execute(function($) {
    var success = function(fieldName) {
      var $msg = $('#msg_' + fieldName);
      $msg.className = 'success';
      $msg.innerHTML = 'V';
    };
    var failure = function(fieldName) {
      var $msg = $('#msg_' + fieldName);
      $msg.className = 'failure';
      $msg.innerHTML = 'X';
    };

//--------------------------------------------------[validator]
    window.validator = new Validator($('#form'), {
      password: {
        required: true,
        onSuccess: success,
        onFailure: failure
      },
      'password_confirm': {
        required: true,
        equals: 'password',
        onSuccess: success,
        onFailure: failure
      },
      age: {
        required: true,
        handler: function(value) {
          return parseInt(value, 10) + '' === value && value >= 18 && value <= 80;
        },
        onSuccess: success,
        onFailure: failure
      },
      from: {
        required: true
      },
      os: {
        required: true
      },
      games: {
        required: true
      },
      language: {
        required: true
      },
      description: {
        required: true,
        minLength: 10,
        maxLength: 200,
        onSuccess: success,
        onFailure: failure
      }
    });

    window.validator.validate();
  });
  </script>
</div>
</body>
</html>
