<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Validator</title>
<link rel="stylesheet" href="../stylesheets/framework.css">
<script src="../dev.js"></script>
<style>
table { table-layout: fixed; width: 600px; }
col.key { width: 100px; }
col.value { width: 220px; }
th { text-align: right; }
th.submit { text-align: center; }
textarea { resize: none; }
span { display: inline-block; padding: 3px 5px; border-radius: 3px; font-size: 12px; line-height: 1; }
span.success { border: 1px solid #D6E9C6; background: #DFF0D8; color: #468847; }
span.failure { border: 1px solid #EED3D7; background: #F2DEDE; color: #B94A48; }
</style>
</head>
<body>
<div id="content">
  <h1>Validator</h1>
  <fieldset>
    <legend>表单验证</legend>
    <form id="form" method="get" action="http://www.lianzhong.com/">
      <table>
        <colgroup>
          <col class="key">
          <col class="value">
          <col class="message">
        </colgroup>
        <tbody>
          <tr>
            <th>姓名：</th>
            <td><input name="name" type="text" value=""></td>
            <td><span id="msg_name"></span></td>
          </tr>
          <tr>
            <th>信箱：</th>
            <td><input name="email" type="text"></td>
            <td><span id="msg_email"></span></td>
          </tr>
          <tr>
            <th>年龄：</th>
            <td><input name="age" type="text" value="28"></td>
            <td><span id="msg_age"></span></td>
          </tr>
          <tr>
            <th>密码：</th>
            <td><input name="password" type="password"></td>
            <td><span id="msg_password"></span></td>
          </tr>
          <tr>
            <th>重复密码：</th>
            <td><input name="password_confirm" type="password"></td>
            <td><span id="msg_password_confirm"></span></td>
          </tr>
          <tr>
            <th>操作系统：</th>
            <td>
              <select name="os">
                <option value="Win98">Win98</option>
                <option value="WinXP">WinXP</option>
                <option value="Win7" selected>Win7</option>
                <option value="MacOS">MacOS</option>
              </select>
            </td>
            <td><span id="msg_os"></span></td>
          </tr>
          <tr>
            <th>玩过的游戏：</th>
            <td>
              <select name="games" size="6" multiple>
                <option value="pal">仙剑奇侠传</option>
                <option value="sc" selected>星际争霸</option>
                <option value="wow" selected disabled>魔兽世界</option>
                <optgroup label="id Software" disabled>
                  <option value="doom" selected>毁灭战士</option>
                  <option value="quake" selected>雷神之锤</option>
                </optgroup>
              </select>
            </td>
            <td><span id="msg_games"></span></td>
          </tr>
          <tr>
            <th>语言能力：</th>
            <td>
              <input name="language" value="汉语" type="checkbox">汉语
              <input name="language" value="英语" type="checkbox">英语
              <input name="language" value="法语" type="checkbox">法语
              <input name="language" value="日语" type="checkbox">日语
            </td>
            <td><span id="msg_language"></span></td>
          </tr>
          <tr>
            <th>所在省份：</th>
            <td>
              <input name="from" value="广东" type="radio" checked disabled>广东
              <input name="from" value="湖南" type="radio">湖南
              <input name="from" value="浙江" type="radio" checked>浙江
              <input name="from" value="江苏" type="radio">江苏<br>
              <input name="from" value="黑龙江" type="checkbox" checked disabled>黑龙江
              <input name="from" value="吉林" type="checkbox" checked>吉林
              <input name="from" value="辽宁" type="checkbox">辽宁<br>
              <input name="from" type="text" value="地球" disabled>
            </td>
            <td><span id="msg_from"></span></td>
          </tr>
          <tr>
            <th>自我介绍：</th>
            <td><textarea name="description" rows="5" cols="25" disabled>普通玩家</textarea></td>
            <td><span id="msg_description"></span></td>
          </tr>
          <tr>
            <th colspan="3" class="submit">
              <button type="submit">确定提交</button>
            </th>
          </tr>
        </tbody>
      </table>
    </form>
  </fieldset>
  <script>
  execute(function($) {
    var $form = $('#form');

//    console.log($form.getFieldValue('age'));
//    console.log($form.getFieldValue('os'));
//    console.log($form.getFieldValue('games'));
//    console.log($form.getFieldValue('language'));
//    console.log($form.getFieldValue('from'));
//    console.log($form.getFieldValue('description'));

    $form.setValidationRules({
      password: {
        required: true
      },
      'password_confirm': {
        triggerEventType: 'input',
        required: true,
        equals: 'password'
      },
      age: {
        required: true,
        handler: function(value) {
          return parseInt(value, 10) + '' === value && value >= 18 && value <= 80;
        }
      },
      from: {
        required: true
      },
      os: {
        required: true
      },
      games: {
        required: true
      },
      language: {
        required: true
      },
      description: {
        required: true,
        minLength: 10,
        maxLength: 200
      }
    }, {
      onFieldValidationFinish: function(name, value, result) {
        console.log(name, value, result);
        var $msg = $('#msg_' + name);
        $msg.className = result ? 'success' : 'failure';
        $msg.innerHTML = result ? 'V' : 'X';
      }
    });
  });
  </script>
</div>
</body>
</html>
