<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>OurJS Overview</title>
<link rel="stylesheet" href="/stylesheets/common.css">
<link rel="stylesheet" href="stylesheets/framework.css">
<script src="../our.js"></script>
<!--<script src="/scripts/common.js"></script>-->
<style>
body { padding: 50px 0; background: url(images/bg.jpg); }
div#content { width: 880px; margin: 0 auto; padding: 50px 50px; border: 1px solid silver; box-shadow: 0 0 10px black; background: white; }

#header2 { position: fixed; left: 0; top: 0; z-index: 10000; width: 100%; height: 35px; box-shadow: 0 0 3px black; background: #30322F; }
#menu2 { position: relative; width: 960px; height: 35px; margin: 0 auto; padding-left: 30px; background: url(images/logo.png) no-repeat left center; color: #B3B7BC; }
#menu2 ul { list-style: none; float: left; margin-top: 3px; margin-right: 10px; height: 29px; padding: 0; overflow: hidden; }
#menu2 li { display: none; }
#menu2 li.selected { display: block; }
#menu2 li a { display: block; height: 29px; padding: 0 10px; border-top: 1px solid #30322F; color: #B3B7BC; line-height: 29px; white-space: nowrap; }
#menu2 li a:hover { text-decoration: none; }
#menu2 ul.active { border-bottom: 1px solid #30322F; box-shadow: 0 0 3px black; background: #40423F; }
#menu2 ul.active li { display: block; }
#menu2 ul.active li.selected a { background: url(images/bg_menu_selected.png); color: white; }

.example { list-style-type: circle; padding: 5px 5px 5px 2em; border: 1px solid gainsboro; border-radius: 5px; background: whitesmoke; }
.example li { margin: 15px 0; }
.example p { margin: 5px 0; }
.example code { color: sienna; }
pre span,
code span { border: 1px solid #9acd32; background: #f8fff8; }
</style>
</head>
<body>
<div id="header2">
  <div id="menu2">
    <ul>
      <li><a href="#">工作流程</a></li>
      <li class="selected"><a href="#">开发规范</a></li>
      <li><a href="#">OurJS</a></li>
      <li><a href="#">UI 组件</a></li>
      <li><a href="#">常用模版</a></li>
      <li><a href="#">资源下载</a></li>
    </ul>
    <ul>
      <li><a href="#">文件创建规范</a></li>
      <li><a href="#">文本书写规范</a></li>
      <li class="selected"><a href="#">HTML 编码规范</a></li>
      <li><a href="#">CSS 编码规范</a></li>
      <li><a href="#">JavaScript 编码规范</a></li>
    </ul>
    <ul>
      <li><a href="#">文件创建规范</a></li>
      <li><a href="#">文本书写规范</a></li>
      <li><a href="#">HTML 编码规范</a></li>
      <li><a href="#">CSS 编码规范</a></li>
      <li class="selected"><a href="#">JavaScript 编码规范</a></li>
    </ul>
  </div>
</div>
<script>
execute(function($) {
//  return;
//  $('#header2').setStyle('position', 'fixed');

  var aniPool = {};
  $('#menu2').find('ul').forEach(function($ul, index, uls) {
    $ul.setStyle('width', $ul.offsetWidth);
    var $li = $ul.getFirst();
    var selectedIndex = $ul.getChildren().indexOf($ul.find('.selected')[0]);
    var nextSiblings = uls.slice(index + 1);
    aniPool[$ul.uid] = new Animation()
        .addClip(new Fx.Morph($ul, {width: 240}), 100, 150, 'easeInOut')
        .addClip(new Fx.Morph($ul, {height: 151}), 300, 300, 'easeInOut')
        .addClip(new Fx.Morph($li, {marginTop: 0}), 300, 300, 'easeInOut')
        .on('playstart', function() {
          $ul.addClass('active');
          $li.setStyles({marginTop: -30 * selectedIndex});
//          nextSiblings.forEach(function($sibling) {
//            $sibling.fadeOut({
//              duration: 100,
//              callback: initItem
//            });
//          });
        })
        .on('reversefinish', function() {
          $ul.removeClass('active');
          nextSiblings.forEach(function($sibling) {
//            $sibling.fadeIn();
          });
        });
  });
  $('#menu2')
      .on('mouseenter', function(e) {
        aniPool[this.uid].play();
      }, function() {
        return this.tagName === 'UL';
      })
      .on('mouseleave', function(e) {
        aniPool[this.uid].reverse();
      }, function() {
        return this.tagName === 'UL';
      });
}, true);
</script>
<div id="content">
  <h1>OurJS 概述</h1>

  <p>OurJS 是一个易学易用的、适用于 WEB 应用开发的 JavaScript 框架，开发者只需要有 JavaScript 和 DOM 的一些基础知识<sup>1</sup>，即可编写出兼容各主流浏览器<sup>2</sup>的 WEB 应用。</p>
  <p>OurJS 要求浏览器运行在“标准模式”下，以获得更好的兼容性，并发挥浏览器的最大功效。当浏览器工作在非标准模式下时，开发者将收到一条警告信息。</p>
  <p>OurJS 具备完善的功能，也提供了基于组件形式的扩展，因此能够解决大部分需求。当必须引入其他的类库以满足特定需求时，要注意一点：OurJS 使用了侵入式设计<sup>3</sup>，因此只能和其他非侵入式设计的类库共存<sup>4</sup>。</p>
  <ol class="comment">
    <li>开发者要了解 JS 的变量、数据类型、运算符、流程控制，以及 DOM 的一些常见的 API。</li>
    <li>指 IE6 IE7 IE8 IE9 Firefox Chrome Safari Opera 以及其他使用 Trident 和 WebKit 内核的浏览器。</li>
    <li>此处的“侵入式设计”是指通过扩展 JS 对象的原型来增加新的功能。使用这种方式可以提供更接近原生语法的 API。</li>
    <li>可以和 jQuery 共存。</li>
  </ol>

  <h2>特点</h2>
  <p>
    与其他 JavaScript 框架（类库）相比，OurJS 要更加<strong>易学易用</strong>。<br>
    使 OurJS 变得如此“简单”的，是以下 3 个特点：
  </p>
  <blockquote>
    <p>"Everything should be made as simple as possible, but no simpler." -- Albert Einstein<br>
      “任何事情都应该尽可能的做到简单，简单到极致。”—— 爱因斯坦
    </p>
  </blockquote>

  <h3>1 语法自然</h3>
  <h4>OurJS 没有标新立异的语法或充满个性的方法名，而是尽量使用符合源生 JS 或 DOM 习惯的语法，提供一套简洁自然的 API。</h4>
  <ul>
    <li>
      <p>
        对于一些在新的规范（草案）中定义的，或已成为事实标准的特性，在尚未支持的浏览器上通过技术手段予以补缺。<br>
        这些 API 的语法是原生的，也是最自然的。使用它们时，开发者可以像面对最新的浏览器一样写代码，而感觉不到 OurJS 的存在。<br>
        举例如下：
      </p>
      <ul class="example">
        <li>
          <p><code>anArray.<span>forEach</span>(function(item) {...});</code></p>
          <p class="comment">Array 对象的 forEach 方法是 ECMAScript 5 引入的，本来只有在较新版本的浏览器中才能使用，但现在可以放心使用了。</p>
        </li>
        <li>
          <p><code>if (aString.<span>startsWith</span>('ex-') {...}</code></p>
          <p class="comment">ECMAScript 6 (Harmony) 中的提案：检查字符串是否以指定的子串开始。这个方法很实用，有助于提高代码的可读性。</p>
        </li>
        <li>
          <p><code><span>localStorage.setItem</span>('data', <span>JSON.stringify</span>(userData));</code></p>
          <p class="comment">HTML5 的 localStorage 对象和 ECMAScript 5 的 JSON 对象原本在 IE6 IE7 中是不支持的，但现在可以放心使用了。</p>
        </li>
        <li>
          <p><code><span>Element.prototype</span>.newMethod = function() {...};</code></p>
          <p class="comment">IE6 IE7 本来没有 Element 构造函数，但现在可以通过扩充 Element.prototype 来为页面上的 DOM 元素添加新特性了。</p>
        </li>
        <li>
          <p><code>element.<span>innerText</span> = 'new content';</code></p>
          <p class="comment">元素的 innerText 特性是 IE 最先引入的，目前只有 Firefox 不支持，但现在可以放心使用了。</p>
        </li>
      </ul>
    </li>
    <li>
      <p>
        对于有规范支持但无法通过技术手段实现补缺的，或者无规范支持仅为方便使用而提供的特性，以扩展的方式提供。<br>
        设计这些扩展的 API 时均参考了原生 API 的语法，力求语义明确，并具备“自注释”的特点。<br>
        举例如下：
      </p>
      <ul class="example">
        <li>
          <p><code>element.<span>setStyles({position: 'fixed', right: 0, bottom: 0})</span>;</code></p>
          <p class="comment">
            IE6 并不支持 CSS2 引入的固定定位，但现在通过使用 element.setStyle/setStyles 方法，可以实现在各浏览器中的一致的表现，而使用 element.getStyle/getStyles，也将获得预期的返回值 'fixed'。<br>
            值得注意的是，setStyles 是设置多个样式，而 setStyle 是设置一个样式，二者的用途不同、名称不同、参数也不同。
          </p>
        </li>
        <li>
          <p><code>element.<span>on</span>('click', function(e) {...});</code></p>
          <p class="comment">IE6 IE7 IE8 的事件模型与其他浏览器的不同，但现在可以通过 element.on/off/fire 方法实在各浏览器通用的事件处理函数的绑定/解除绑定/触发了。</p>
        </li>
        <li>
          <p><code>var nextElement = element.<span>getNext</span>();</code></p>
          <p class="comment">要获取一个元素的下一个相邻元素，在 Element Traversal Specification 中推荐的、指定获取元素类型节点的 nextElementSibling 属性仅在较新的浏览器中才支持，在 IE6 IE7 IE8 中只能通过该元素的 nextSibling 属性获取，不过这需要进一步判断，因为得到的可能是一个文本节点，但现在可以在所有浏览器上通过调用元素的 getNext 方法而达到相同的目的了。</p>
        </li>
        <li>
          <p><code>element.<span>addClass</span>('active').<span>putBefore</span>(anotherElement);</code></p>
          <p class="comment">给元素添加一个类名，然后插入到另一个元素的前边。这个需求也可以使用其他无兼容性问题的途径来实现，扩展这两个方法仅是为了方便使用。</p>
        </li>
        <li>
          <p><code>Array.<span>from</span>(element.getElementsByTagName('select')).forEach(function(item){...});</code></p>
          <p class="comment">将一个 NodeList 对象（或其他任意数据类型）转化为数组，以便使用数组的方法进行操作。Array.from 目前尚无规范支持，是仅为方便使用而添加的属性。</p>
        </li>
      </ul>
    </li>
  </ul>

  <h3>2 风格一致 —— 只要掌握了部分用法，就可以轻易的推测出其他部分的用法。</h3>
  <ul>
    <li>
      OurJS 扩展的功能都是通过 JavaScript 的原型机制实现的，即便对 DOM 元素的扩展也是如此（这里对 IE6 IE7 做了特殊处理），这样的好处是可以像调用一个对象的源生方法一样来调用它的扩展方法。<br>
      也就是说，不用再担心分不清你正在操作的对象到底是源生对象还是包装对象了——OurJS 没有“包装对象”的概念。
      <ul class="example">
        <li>
          <p class="comment">调用了扩展方法后，又想调用源生方法？没问题，按照直觉告诉你的方式，写下来就行了。</p>
          <p><code>element.empty().scrollIntoView()</code></p>
        </li>
        <li>
          <p class="comment">想获取地址栏中 Query String 的某个字段？首先想到 location 对象了吗？正是，这个方法就在 location 对象上提供。</p>
          <p><code>location.parameters.id</code></p>
        </li>
        <li>
          <p class="comment">想操作 cookie？为了保持一致的风格，OurJS 提供了一个 cookie 对象。</p>
          <p><code>cookie.get('username')</code></p>
        </li>
      </ul>
    </li>
    <li>只有一个可选参数。</li>
    <li><em>DOM 元素的事件处理。</em></li>
    <li><em>组件的事件处理。</em></li>
    <li><em>可重复使用的功能和一次性使用的功能。</em></li>
  </ul>

  <h3>3 功能完善 —— 提供粒度恰当的功能和组件，可以通过灵活的配置和组合进行自由的设计。</h3>
  <ul>
    <li>
      在扩充对象的功能方面，OurJS 提供比其他库提供了更实用、覆盖面更广的功能，而不仅仅在某个方面提供一堆生僻的扩展（如提供十个完全可以由其他方式代替、仅仅是少些了几个单词的对 String.prototype 的扩展）。<br>
      一些相对复杂的功能也隐藏在简单的 API 之后，如 element.setStyle('position', 'fixed') 提供了 IE6 的固定定位支持，localStorage 对 IE6 IE7 提供的模拟等。
    </li>
    <li>
      组件方面，OurJS 尽量提供可以灵活搭配的各种事件。<br>
      组件包括“功能组件”和“UI 组件”两种，其中功能组件包含 Request 和 Animation 两个对象，UI 组件则可以根据情况进行扩展。
    </li>
    <li>面对复杂的需求，OurJS 提供了“模块 - 应用”机制来化繁为简：将可分离的业务逻辑拆分为多个模块，再通过应用将各模块连接起来。其中每个模块都是完全独立的，有利于协同开发和单元测试。</li>
  </ul>

  <ol class="comment">
    <li>
      此处所说的“简单”不是指功能单一，实际上，OurJS 的功能要超过一些常见的类库。<br>
      简单是相对于复杂而言的，描述的是人们的感觉。<br>
      通常，使用可预期的 API 自由的编程是更简单的。而一旦某个 API 让人感到意外或被束缚，就会令人困惑和厌烦，这样的事情如果一再发生，原本简单的事情也会觉得复杂。<br>
    </li>
  </ol>

</div>
</body>
</html>
